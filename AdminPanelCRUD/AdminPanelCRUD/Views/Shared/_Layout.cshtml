<!DOCTYPE html>
<html lang="zxx">


<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Pustok - Book Store HTML Template</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Use Minified Plugins Version For Fast Page Load -->
    <link rel="stylesheet" type="text/css" media="screen" href="~/assets/css/plugins.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="~/assets/css/main.css" />
    <link rel="shortcut icon" type="image/x-icon" href="image/favicon.ico">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
</head>

<body>
    @await Component.InvokeAsync("Header")
    @RenderBody();

    <!--=================================
    Footer Area
    ===================================== -->
    <footer class="site-footer">
        <div class="container">
            <div class="row justify-content-between  section-padding">
                <div class=" col-xl-3 col-lg-4 col-sm-6">
                    <div class="single-footer pb--40">
                        <div class="brand-footer footer-title">
                            <img src="~/assets/image/logo--footer.png" alt="">
                        </div>
                        <div class="footer-contact">
                            <p>
                                <span class="label">Address:</span><span class="text">
                                    Example Street 98, HH2 BacHa, New
                                    York,
                                    USA
                                </span>
                            </p>
                            <p><span class="label">Phone:</span><span class="text">+18088 234 5678</span></p>
                            <p><span class="label">Email:</span><span class="text">suport@hastech.com</span></p>
                        </div>
                    </div>
                </div>
                <div class=" col-xl-3 col-lg-2 col-sm-6">
                    <div class="single-footer pb--40">
                        <div class="footer-title">
                            <h3>Information</h3>
                        </div>
                        <ul class="footer-list normal-list">
                            <li><a href="#">Prices drop</a></li>
                            <li><a href="#">New products</a></li>
                            <li><a href="#">Best sales</a></li>
                            <li><a href="#">Contact us</a></li>
                            <li><a href="#">Sitemap</a></li>
                        </ul>
                    </div>
                </div>
                <div class=" col-xl-3 col-lg-2 col-sm-6">
                    <div class="single-footer pb--40">
                        <div class="footer-title">
                            <h3>Extras</h3>
                        </div>
                        <ul class="footer-list normal-list">
                            <li><a href="#">Delivery</a></li>
                            <li><a href="#">About Us</a></li>
                            <li><a href="#">Stores</a></li>
                            <li><a href="#">Contact us</a></li>
                            <li><a href="#">Sitemap</a></li>
                        </ul>
                    </div>
                </div>
                <div class=" col-xl-3 col-lg-4 col-sm-6">
                    <div class="footer-title">
                        <h3>Newsletter Subscribe</h3>
                    </div>
                    <div class="newsletter-form mb--30">
                        <form action="https://demo.hasthemes.com/pustok-preview/pustok/php/mail.php">
                            <input type="email" class="form-control" placeholder="Enter Your Email Address Here...">
                            <button class="btn btn--primary w-100">Subscribe</button>
                        </form>
                    </div>
                    <div class="social-block">
                        <h3 class="title">STAY CONNECTED</h3>
                        <ul class="social-list list-inline">
                            <li class="single-social facebook">
                                <a href="#"><i class="ion ion-social-facebook"></i></a>
                            </li>
                            <li class="single-social twitter"><a href="#"><i class="ion ion-social-twitter"></i></a></li>
                            <li class="single-social google">
                                <a href="#">
                                    <i class="ion ion-social-googleplus-outline"></i>
                                </a>
                            </li>
                            <li class="single-social youtube"><a href="#"><i class="ion ion-social-youtube"></i></a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <div class="container">
                <p class="copyright-heading">
                    Suspendisse in auctor augue. Cras fermentum est ac fermentum tempor. Etiam
                    vel
                    magna volutpat, posuere eros
                </p>
                <a href="#" class="payment-block">
                    <img src="~/assets/image/icon/payment.png" alt="">
                </a>
                <p class="copyright-text">
                    Copyright © 2019 <a href="#" class="author">Pustok</a>. All Right Reserved.
                    <br>
                    Design By Pustok
                </p>
            </div>
        </div>
    </footer>

    @*<script src="~/manage/js/main.js"></script>*@
    <script>
        let addToBasketBtns = document.querySelectorAll(".add-to-basket-btn");
        let deleteBtns = document.querySelectorAll(".cross-btn");
        deleteBtns.forEach(btn => btn.addEventListener("click", function (e) {
            e.preventDefault();
            let url = btn.getAttribute("href");
            fetch(url).then(res => {
                //if (res.status == 200) {
                    fetch('/book/getbasket')
                        .then((response) => response.json())
                        .then((data) => {
                            for (let i = 0; i < data.length; i++) {
                            console.log(data[i]);
                                let basketItemCount = document.querySelector(".basketItemCount");
                                //if (data[i].count == 0) btn.parentElement.parentElement.remove()
                                //else {
                                basketItemCount.innerHTML = `<span class="qty basketItemCount">${data[i].count} ×</span>`
                                //}
                                
                            }
                        })
                //}
            })
        }))
        addToBasketBtns.forEach(btn => btn.addEventListener("click", function (e) {
            e.preventDefault();
            let url = btn.getAttribute("href");
            fetch(url).then(res => {
                if (res.status == 200) {
                    Toastify({
                        text: "Kitab sebete elave olundu!",
                        duration: 3000,
                        newWindow: true,
                        close: true,
                        gravity: "top", // `top` or `bottom`
                        position: "right", // `left`, `center` or `right`
                        stopOnFocus: true, // Prevents dismissing of toast on hover
                        style: {
                            background: "linear-gradient(to right, #00b09b, #96c93d)",
                        },
                    }).showToast();
                    fetch('/book/getbasket')
                        .then((response) => response.json())
                        .then((data) => {
                            console.log(data);
                            let container = document.querySelector(".single-cart-block");
                            container.innerHTML = "";
                            for (let i = 0; i < data.length; i++) {
                                if (data[i].count > 0) {
                                    container.innerHTML += `
                                     <div class="cart-product basketItem">
                                        <a href="product-details.html" class="image">
                                          <img class="basketItemImage" src="/uploads/books/${data[i].image}" alt="">
                                           </a>
                                          <div class="content">
                                            <h3 class="title">
                                          <a class="basketItemTitle" href="product-details.html">
                                               ${data[i].name}
                                           </a>
                                          </h3>
                                            <p class="price"><span class="qty basketItemCount">${data[i].count} ×</span>£ ${data[i].price}</p>
                                                  <a href="/book/removefrombasket?bookId=${data[i].bookId}" class="cross-btn"><i class="fas fa-times"></i></a>
                                           </div>
                                     </div>
                                     `;
                                }
                            }
                            //let basketItems = document.querySelectorAll(".basketItem")
                            //basketItems.querySelector(".cross-btn").forEach(btn => btn.addEventListener("click", function (e) {
                            //    e.preventDefault();
                            //    let url = btn.getAttribute("href");
                            //    fetch(url).then(res => {
                            //        if (res.status == 200) {
                            //            fetch('/book/getbasket')
                            //                .then((response) => response.json())
                            //                .then((data) => {
                            //                    console.log(data);
                            //                    for (let i = 0; i < data.length; i++) {
                            //                        let basketItemCount = document.querySelector(".basketItemCount");
                            //                        //if (data[i].count == 0) btn.parentElement.parentElement.remove()
                            //                        //else {
                            //                        basketItemCount.textContent = data[i].count
                            //                        //}
                            //                    }
                            //                })
                            //        }
                            //    })
                            //}))
                       
                        })
                }
                else {
                    Toastify({
                        text: "Kitab sebete elave oluna bilmedi!",
                        duration: 3000,
                        newWindow: true,
                        close: true,
                        gravity: "top", // `top` or `bottom`
                        position: "right", // `left`, `center` or `right`
                        stopOnFocus: true, // Prevents dismissing of toast on hover
                        style: {
                            background: "linear-gradient(to right, #ffafcc, #e76f51)",
                        },
                    }).showToast();
                }
            })

        }))
    </script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
    <!-- Use Minified Plugins Version For Fast Page Load -->
    <script src="~/assets/js/plugins.js"></script>
    <script src="~/assets/js/ajax-mail.js"></script>
    <script src="~/assets/js/custom.js"></script>
</body>


</html>